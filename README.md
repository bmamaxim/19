19


Задание 1


      Подключите СУБД PostgreSQL для работы в проекте, для этого:
      
      Создайте базу данных в ручном режиме.
      
      
      Внесите изменения в настройки подключения.
      
      
      Мы уже работали с этой СУБД на курсе «Работа с базами данных». 
      
      В уроке 17.1 «Введение в работу с базами данных» подробно описан процесс создания базы данных.

Задание 2

      В приложении каталога создайте модели:
      
      Product,
      Category.
      Опишите для них начальные настройки.
      
      К начальным настройкам модели относятся метод 
      __str__
       и 
      class Meta
       с описанием свойств модели.

Задание 3

      Для каждой модели опишите следующие поля:
      
      Product
      Наименование
      Описание
      Изображение (превью)
      Категория
      Цена за покупку
      Дата создания (записи в БД)
      Дата последнего изменения (записи в БД)
      Category
      Наименование
      Описание
      Свяжите продукт и категорию, используя связь между таблицами «Один ко многим».
      
      У одной категории может быть много продуктов, но у одного продукта может быть только одна категория.
      
      Воспользуйтесь специальным полем модели — ForeignKey().
      При необходимости подробнее про то, как работает такое поле, можно почитать тут.
      
      Поля «Дата создания» и «Дата последнего изменения» стали стандартом для моделей. Их общепринятые названия — created_at и updated_at соответственно.
      
      Примечание
      
      Для поля с изображением необходимо добавить соответствующие настройки (MEDIA URL, MEDIA ROOT, настроить URL для отображения медиаданных) в проект, а также установить библиотеку для работы с изображениями 
      Pillow
      . Не забудьте обновить файл с зависимостями для проекта после установки новой библиотеки.

Задание 4

      Перенесите отображение моделей в базу данных с помощью инструмента миграций, для этого:
      
      создайте миграции для новых моделей;
      примените миграции;
      внесите изменения в модель продукта, добавьте поле «Дата производства продукта» (
      manufactured_at
      ), примените обновление структуры с помощью миграций;
      откатите миграцию до состояния, когда поле «Дата производства продукта» (
      manufactured_at
      ) для модели продукта еще не существовало, и удалите лишнюю миграцию.
      Важно сохранять всю историю миграций проекта для сохранения целостности базы данных проекта.
      
      Не забудьте добавить все выполненные миграции в коммит, а затем отправить в удаленный репозиторий на GitHub.
      
      Подсказка
      Чтобы сбросить миграцию до определенной (по номеру), можно воспользоваться командой 
      python manage.py migrate имя_приложения номер_миграции (например, 0003)
      . Номер миграции написан в названии файла.

 

Задание 5
      Для моделей категории и продукта настройте отображение в административной панели. Для категорий выведите id и наименование в список отображения, а для продуктов выведите в список id, название, цену и категорию.
      
      При этом интерфейс вывода продуктов настройте так, чтобы можно было результат отображения фильтровать по категории, а также осуществлять поиск по названию и полю описания.
      
       
      
      Подсказка
      Все настройки производите в файле admin.py.
      
      Для управления полями, которые выводятся в списке в панели администратора, используйте настройку list_display, для настройки фильтров — list_filter, для управления поиском по полям — search_fields
      
      В общем случае настройки административной панели для модели будут выглядеть следующим образом:
      
      @admin.register(Имя_модели)
      class Имя_МоделиAdmin(admin.ModelAdmin):
          list_display = (список_полей_модели_для_отображения)
          list_filter = (список_полей_для_фильтрации)
          search_fields = (список_полей_для_поиска)
      
      Используйте различные настройки для управления функционалом административной панели. Использовать все три настройки одновременно необязательно.

 

Задание 6

      Через инструмент shell заполните список категорий, а также выберите список категорий, применив произвольные рассмотренные фильтры. В качестве решения приложите скриншот.
      Установите библиотеку 
      ipython
       для комфортной работы с инструментом 
      shell
      . Не забудьте зафиксировать изменения в файле зависимостей проекта.
      
       
      
      Подсказка
      В рамках задания реализуйте ORM-запросы на создание объектов, получение всех объектов, получение одного объекта по 
      id
      , фильтрацию объектов по определенному полю и исключение объектов из выборки.
      
      Для доступа к объектам используйте команду 
      Model.objects…
       и дополняйте ее различными методами.
      
      Документацию для методов взаимодействия с базой данных через Django ORM можно найти тут.
      
      Чтобы создать объект, необходимо использовать метод 
      create()
       и перечислить все обязательные поля
      
      Чтобы получить список всех объектов, необходимо использовать метод 
      all()
      .
      
      Чтобы получить один объект, используйте метод 
      get()
      .
      
      Чтобы отфильтровать объекты по определенному значению поля, необходимо использовать метод 
      filter()
       и указать в скобках 
      имя_поля=”значение_поля”
      .
      
      Чтобы исключить объекты из выборки по определенному значению поля, необходимо использовать метод 
      exclude()
       и указать в скобках 
      имя_поля=”значение_поля”
      .
      
       
      
      Сформируйте фикстуры для заполнения базы данных.
      Фикстуры создайте командой. Для управления кодировкой используйте опцию 
      -Xutf8
       для команды. Такой параметр уместно будет использовать на операционной системе Windows.
      
      В общем случае команда для создания фикстур будет выглядеть следующим образом:
      
      python -Xutf8 manage.py dumpdata имя_приложения > имя_папки_с_фикстурами/имя_приложения_data.json
      .
      
      Напишите кастомную команду, которая умеет заполнять данные в базу данных, при этом предварительно ее зачищать от старых данных.
       
      
      Подсказка
       
      
      Примечание
      
      Последний пункт можно реализовать в связке с инструментом работы с фикстурами, можно описать вставку данных отдельными запросами.

Дополнительное задание
В контроллер отображения главной страницы добавить выборку последних пяти товаров и вывод их в консоль.
Создать модель для хранения контактных данных и попробовать вывести данные, заполненные через админку, на страницу с контактами.
Примечание: дополнительные задания, помеченные звездочкой, желательны, но не обязательны к выполнению.


